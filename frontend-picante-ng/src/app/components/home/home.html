<nav class="navbar navbar-expand-lg navbar-dark bg-danger px-4 shadow-sm">
  <a class="navbar-brand fw-bold" href="#">üå∂Ô∏è El Picante System</a>
  <div class="ms-auto">
    <span class="text-white me-3" *ngIf="currentUser">
      Hola, {{ currentUser.username }}
    </span>
    <button class="btn btn-light btn-sm text-danger fw-bold" (click)="logout()">
      Salir
    </button>
  </div>
</nav>

<div class="container-fluid mt-3" *ngIf="currentUser">
  <!-- Barra de b√∫squeda mejorada -->
  <div class="search-container mb-4">
    <div class="search-wrapper">
      <div class="input-group search-input-group">
        <span class="input-group-text search-icon">üîç</span>
        <input 
          type="text" 
          class="form-control search-input" 
          placeholder="Busca platos, ingredientes..." 
          [(ngModel)]="searchText"
          (input)="selectedCategory = null">
        <button 
          *ngIf="searchText.trim()" 
          type="button" 
          class="btn btn-outline-danger clear-btn" 
          (click)="searchText = ''; selectedCategory = null"
          title="Limpiar b√∫squeda">
          ‚úï
        </button>
      </div>
      <div class="search-results-info" *ngIf="searchText.trim()">
        <span class="badge bg-danger">
          {{ getSearchResults().length }} 
          {{ getSearchResults().length === 1 ? 'plato encontrado' : 'platos encontrados' }}
        </span>
      </div>
    </div>
  </div>

  <!-- Barra de navegaci√≥n de categor√≠as -->
  <div class="category-nav-container mb-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="text-danger fw-bold mb-0">üçΩÔ∏è Nuestra Carta</h2>
      <button *ngIf="isAdmin()" class="btn btn-dark btn-sm" (click)="goAdmin()">Panel Admin</button>
    </div>
    
    <!-- Barra horizontal de categor√≠as con desplazamiento -->
    <div class="category-nav-scroll">
      <div class="category-nav d-flex gap-2 pb-2">
        <button 
          class="btn category-btn" 
          [class.active]="selectedCategory === null"
          (click)="selectCategory(null)">
          Todos
        </button>
        <button 
          *ngFor="let category of getFilteredCategories()" 
          class="btn category-btn"
          [class.active]="selectedCategory?.id === category.id"
          (click)="selectCategory(category)">
          {{ category.name }}
        </button>
      </div>
    </div>
  </div>

  <!-- Productos organizados por categor√≠a -->
  <div class="row">
    <div class="col-12">
      <!-- Mostrar resultados de b√∫squeda si hay texto -->
      <div *ngIf="searchText.trim() && getSearchResults().length > 0">
        <h3 class="category-title text-danger border-bottom border-danger pb-2 mb-4">
          Resultados de b√∫squeda para "{{ searchText }}"
        </h3>
        <div class="row">
          <div *ngFor="let product of getSearchResults()" class="col-lg-4 col-md-6 mb-3">
            <div class="card product-card h-100 shadow-sm">
              <div class="card-body">
                <h5 class="card-title text-danger fw-bold">{{ product.name }}</h5>
                <p class="card-text text-muted small">{{ product.description }}</p>
                <p class="card-text text-info small">üìÇ {{ product.category?.name }}</p>
                <div class="d-flex justify-content-between align-items-center">
                  <span class="price-tag fw-bold text-success">S/ {{ product.price.toFixed(2) }}</span>
                  <button class="btn btn-danger btn-sm">Agregar</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Mostrar sin b√∫squeda -->
      <div *ngIf="!searchText.trim()">
        <div *ngIf="selectedCategory === null">
          <!-- Mostrar todas las categor√≠as -->
          <div *ngFor="let category of categories" class="category-section mb-5">
            <h3 class="category-title text-danger border-bottom border-danger pb-2 mb-3">
              {{ category.name }}
            </h3>
            <div class="row">
              <div *ngFor="let product of getProductsByCategory(category.id)" class="col-lg-4 col-md-6 mb-3">
                <div class="card product-card h-100 shadow-sm">
                  <div class="card-body">
                    <h5 class="card-title text-danger fw-bold">{{ product.name }}</h5>
                    <p class="card-text text-muted small">{{ product.description }}</p>
                    <div class="d-flex justify-content-between align-items-center">
                      <span class="price-tag fw-bold text-success">S/ {{ product.price.toFixed(2) }}</span>
                      <button class="btn btn-danger btn-sm">Agregar</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div *ngIf="selectedCategory !== null">
          <!-- Mostrar productos de una categor√≠a espec√≠fica -->
          <h3 class="category-title text-danger border-bottom border-danger pb-2 mb-4">
            {{ selectedCategory.name }}
          </h3>
          <div class="row">
            <div *ngFor="let product of getProductsByCategory(selectedCategory.id)" class="col-lg-4 col-md-6 mb-3">
              <div class="card product-card h-100 shadow-sm">
                <div class="card-body">
                  <h5 class="card-title text-danger fw-bold">{{ product.name }}</h5>
                  <p class="card-text text-muted small">{{ product.description }}</p>
                  <div class="d-flex justify-content-between align-items-center">
                    <span class="price-tag fw-bold text-success">S/ {{ product.price.toFixed(2) }}</span>
                    <button class="btn btn-danger btn-sm">Agregar</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Mensaje si no hay resultados -->
      <div *ngIf="searchText.trim() && getSearchResults().length === 0" class="alert alert-warning" role="alert">
        <strong>Sin resultados:</strong> No se encontraron productos que coincidan con "{{ searchText }}"
      </div>
    </div>
  </div>
</div>